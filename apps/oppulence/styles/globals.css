@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Semantic Color System */
    --surface: 255 255 255;
    --surface-elevated: 250 250 250;
    --surface-lowered: 245 245 245;
    
    --content: 17 24 39;
    --content-subtle: 55 65 81;
    --content-muted: 107 114 128;
    
    --accent: 79 70 229;
    --accent-subtle: 99 102 241;
    --accent-muted: 129 140 248;

    /* Glass Variables */
    --glass-bg: 255 255 255;
    --glass-border: 255 255 255;
    --glass-gradient: linear-gradient(
      135deg,
      rgb(var(--glass-bg) / 0.2),
      rgb(var(--glass-bg) / 0.05) 50%,
      rgb(var(--glass-bg) / 0.1) 100%
    );
    --glass-shine: linear-gradient(
      45deg,
      transparent 0%,
      rgb(var(--glass-border) / 0.1) 100%
    );

    /* Animation Variables */
    --transition-ease: cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    
    /* Spacing Variables */
    --page-margin: max(1rem, calc((100vw - 1280px) / 2));
    --header-height: 4rem;
    
    /* Shadow Variables */
    --shadow-color: 0deg 0% 0%;
    --shadow-strength: 1%;
    --shadow-surface: 0 4px 6px -1px rgb(0 0 0 / 0.1),
                     0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  /* Dark mode overrides */
  @media (prefers-color-scheme: dark) {
    :root {
      --surface: 17 24 39;
      --surface-elevated: 31 41 55;
      --surface-lowered: 24 31 47;
      
      --content: 255 255 255;
      --content-subtle: 209 213 219;
      --content-muted: 156 163 175;
      
      --glass-bg: 255 255 255;
      --glass-border: 255 255 255;
      
      --shadow-strength: 50%;
    }
  }

  /* Enhanced defaults */
  html {
    scroll-behavior: smooth;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    touch-action: manipulation;
  }

  body {
    background-color: rgb(var(--surface));
    color: rgb(var(--content));
    transition: background-color 0.3s var(--transition-ease);
  }

  /* Focus styles */
  :focus-visible {
    outline: 2px solid rgb(var(--accent));
    outline-offset: 2px;
  }

  /* Selection styling */
  ::selection {
    background-color: rgb(var(--accent) / 0.2);
    color: rgb(var(--content));
  }
}

@layer utilities {
  /* Premium Glass Effects */
  .glass {
    background: var(--glass-gradient);
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    border: 1px solid rgb(var(--glass-border) / 0.1);
    box-shadow: 0 8px 32px 0 rgb(0 0 0 / 0.08);
    position: relative;
    overflow: hidden;
  }

  .glass::before {
    content: "";
    position: absolute;
    inset: 0;
    background: var(--glass-shine);
    opacity: 0;
    transition: opacity 0.3s var(--transition-ease);
  }

  .glass:hover::before {
    opacity: 1;
  }

  /* Glass Variants */
  .glass-card {
    @apply glass rounded-2xl p-6;
  }

  .glass-panel {
    @apply glass rounded-3xl p-8 relative;
    box-shadow: 
      0 8px 32px 0 rgb(0 0 0 / 0.08),
      0 0 0 1px rgb(var(--glass-border) / 0.1);
  }

  .glass-button {
    @apply glass rounded-xl px-6 py-3 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98];
  }

  /* Modern Card Effects */
  .card-highlight {
    position: relative;
    background: rgb(var(--surface-elevated));
    border-radius: 1rem;
    padding: 1.5rem;
  }

  .card-highlight::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 1rem;
    padding: 2px;
    background: linear-gradient(
      45deg,
      rgb(var(--accent) / 0.5),
      rgb(var(--accent-subtle) / 0.5)
    );
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask-composite: exclude;
    -webkit-mask-composite: destination-out;
  }

  /* Text balance utilities */
  .text-balance {
    text-wrap: balance;
  }

  .text-pretty {
    text-wrap: pretty;
  }

  /* Enhanced scrollbar */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: rgb(var(--content-muted) / 0.3) transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: rgb(var(--content-muted) / 0.3);
    border-radius: 3px;
    transition: background-color 0.3s var(--transition-ease);
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: rgb(var(--content-muted) / 0.5);
  }

  /* Premium Hover Effects */
  .hover-lift {
    transition: transform 0.3s var(--transition-ease),
                box-shadow 0.3s var(--transition-ease);
  }

  .hover-lift:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-surface);
  }

  /* Gradient Text */
  .gradient-text {
    @apply bg-clip-text text-transparent;
    background-image: linear-gradient(
      135deg,
      rgb(var(--accent)),
      rgb(var(--accent-subtle))
    );
  }
}

/* Code block styling */
code {
  counter-reset: step;
  counter-increment: step 0;
}

code .line::before {
  content: counter(step);
  counter-increment: step;
  width: 1rem;
  padding-right: 1.5rem;
  display: inline-block;
  position: sticky;
  left: 0;
  background-color: rgb(var(--surface));
  text-align: right;
  color: rgb(var(--content-muted) / 0.4);
}

/* Legacy scrollbar (maintaining backward compatibility) */
.dub-scrollbar {
  @apply custom-scrollbar;
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
